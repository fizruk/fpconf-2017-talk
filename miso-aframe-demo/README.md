# miso-aframe-demo

Это демонстрационный проект Miso A-Frame.

[![Демо Miso + A-Frame.](/images/miso-aframe-demo-screenshot.png)][miso-aframe-demo-view]

## О проекте

Miso A-Frame — это биндинги к JavaScript-фреймворку A-Frame,
который позволяет создавать интерактивные вирутальные миры
на основе WebVR и three.js.

В этом демо-проекте показаны основные возможности Miso A-Frame.
Конечный результат можно посмотреть в
`dist/demo.jsexe/index.html`
([просмотр][miso-aframe-demo-view], [исходный код][miso-aframe-demo-src]).

[miso-aframe-demo-view]: https://fizruk.github.io/fpconf-2017-talk/miso-aframe-demo/dist/demo.jsexe/index.html
[miso-aframe-demo-src]:  /miso-aframe-demo/dist/demo.jsexe/index.html

## Системные требования

### Stack

Этот проект собирается при помощи [Stack](https://www.haskellstack.org).

Stack может собирать проекты, а также устанавливать компиляторы GHC и GHCJS.

### GHCJS

Запустите команду

```
stack setup
```

Эта команда может занять много времени (несколько часов),
поскольку все пакеты собираются из исходников.
Кроме того, GHCJS собирает свои версии основных пакетов после установки
самого компилятора.

### Node.js

Для работы интерпретатора также необходим [Node.js](https://nodejs.org/en/).

Для взаимодействия интерпретатора с браузером, установите пакеты
`socket.io`, `finalhandler` и `serve-static`:

```
npm install socket.io finalhandler serve-static --global
```

## Сборка проекта

Для сборки запустите специальный скрипт

```
./build.sh
```

Этот скрипт соберёт приложение и скопирует статические файлы
(в том числе, заменив `index.html` на нужный).

После этого приложение должно автоматически открыться в браузере.

## Запуск интерпретатора

Чтобы запустить интерпретатор запустите специальный скрипт

```
./repl.sh
```

Эта команда запустит интерпретатор и поднимет локальный сервер
по адресу http://localhost:6401 (порт может отличаться, смотрите вывод интерпретатора).

Откройте в браузере страницу по адресу http://localhost:6401/ghcjsiClient.html

Чтобы (пере)запустить проект, выполните

```
reloadAFrameApp main
```

После изменения исходных файлов выполните

```
:reload
```

чтобы загрузить изменения в интерпретатор.
А затем

```
reloadAFrameApp main
```

чтобы загрузить изменения в браузер.

## Этапы проекта

Реализация демонстрационного проекта разбита на небольшие этапы.
Каждый этап представлен в исходном коде функцией `stepN`, где `N` — номер этапа.

Вы можете загрузить нужный этап в браузер, используя `reloadAFrameApp`.
Например, первый этап можно загрузить так:

```
reloadAFrameApp step1
```

Вы можете подставить функцию для нужного вам этапа в реализацию `main`,
чтобы собрать standalone-версию нужного этапа.
